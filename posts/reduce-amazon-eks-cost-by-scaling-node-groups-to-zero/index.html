<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Reduce Amazon EKS cost by scaling node groups to zero</title>
<link rel="stylesheet" href="/assets/built/screen.css?v=ce0a9a97d4">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,700;1,400;1,700&family=Mulish:ital,wght@0,400;0,700;0,800;1,400;1,700&display=swap">
<script>
        if (localStorage.getItem('alto_dark') == 'true') {
            document.documentElement.classList.add('dark-mode');
        }
    </script>
<link rel="icon" href="https://digitalpress.fra1.cdn.digitaloceanspaces.com/clrvv0c/2023/04/code-branch.png" type="image/png">
<link rel="canonical" href="https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta property="og:site_name" content="Re Alvarez Parmar&#x27;s Blog">
<meta property="og:type" content="article">
<meta property="og:title" content="Reduce Amazon EKS cost by scaling node groups to zero">
<meta property="og:description" content="Amazon EKS just released the support for Kubernetes version 1.24. The new version supports a bunch of cool features. My favorite feature in this release is the ability to scale EKS managed node groups to (and from) zero.

Many customers I engage with have some workloads that don’t">
<meta property="og:url" content="https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/">
<meta property="og:image" content="https://images.unsplash.com/photo-1591617870684-6e861e6a48ad?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDR8fGdyYXBofGVufDB8fHx8MTY2ODYyODQ5Ng&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;2000content/images/size/w1200">
<meta property="article:published_time" content="2022-11-16T19:56:15.000Z">
<meta property="article:modified_time" content="2022-11-16T23:08:28.000Z">
<meta property="article:tag" content="Amazon EKS">
<meta property="article:tag" content="Cost">
<meta property="article:tag" content="Kubernetes">
<meta property="article:tag" content="Scaling">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Reduce Amazon EKS cost by scaling node groups to zero">
<meta name="twitter:description" content="Amazon EKS just released the support for Kubernetes version 1.24. The new version supports a bunch of cool features. My favorite feature in this release is the ability to scale EKS managed node groups to (and from) zero.

Many customers I engage with have some workloads that don’t">
<meta name="twitter:url" content="https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/">
<meta name="twitter:image" content="https://images.unsplash.com/photo-1591617870684-6e861e6a48ad?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDR8fGdyYXBofGVufDB8fHx8MTY2ODYyODQ5Ng&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;2000content/images/size/w1200">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Re Alvarez Parmar">
<meta name="twitter:label2" content="Filed under">
<meta name="twitter:data2" content="Amazon EKS, Cost, Kubernetes, Scaling">
<meta name="twitter:site" content="@realz">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="781">
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Re Alvarez Parmar&#x27;s Blog",
        "url": "https://realvz.github.io/blog/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://digitalpress.fra1.cdn.digitaloceanspaces.com/clrvv0c/2023/04/code-branch.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Re Alvarez Parmar",
        "url": "https://realvz.github.io/blog/author/re-2/",
        "sameAs": []
    },
    "headline": "Reduce Amazon EKS cost by scaling node groups to zero",
    "url": "https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/",
    "datePublished": "2022-11-16T19:56:15.000Z",
    "dateModified": "2022-11-16T23:08:28.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://images.unsplash.com/photo-1591617870684-6e861e6a48ad?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxMTc3M3wwfDF8c2VhcmNofDR8fGdyYXBofGVufDB8fHx8MTY2ODYyODQ5Ng&ixlib=rb-4.0.3&q=80&w=2000content/images/size/w1200",
        "width": 1200,
        "height": 781
    },
    "keywords": "Amazon EKS, Cost, Kubernetes, Scaling",
    "description": "Amazon EKS just released the support for Kubernetes version 1.24. The new version supports a bunch of cool features. My favorite feature in this release is the ability to scale EKS managed node groups to (and from) zero.\n\nMany customers I engage with have some workloads that don’t run continuously. A good example is building software. Software build jobs run when new development teams push new code. Outside of business hours, the supporting infrastructure (like nodes) sits idle. Customers use au",
    "mainEntityOfPage": "https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/"
}
    </script>
<meta name="generator" content="Ghost 5.79">
<link rel="alternate" type="application/rss+xml" title="Re Alvarez Parmar&#x27;s Blog" href="https://realvz.github.io/blog/rss/">
<script defer src="https://cdn.jsdelivr.net/ghost/portal@~2.37/umd/portal.min.js" data-i18n="false" data-ghost="https://realvz.github.io/blog/" data-key="875679d7145ae8b3c4db5168c2" data-api="https://realvz.github.io/blog/ghost/api/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
<script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="875679d7145ae8b3c4db5168c2" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://realvz.github.io/blog/" crossorigin="anonymous"></script>
<link href="https://realvz.github.io/blog/webmentions/receive/" rel="webmention">
<script defer src="/public/cards.min.js?v=ce0a9a97d4"></script>
<link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=ce0a9a97d4">
<script defer src="/public/member-attribution.min.js?v=ce0a9a97d4"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-B5XRB3YVTR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B5XRB3YVTR');
</script><style>:root {--ghost-accent-color: #3a88fe;}</style>
</head>
<body class="post-template tag-amazon-eks tag-cost tag-kubernetes tag-scaling has-serif-title has-serif-body">
<div class="site">
<header class="site-header container">
<div class="navbar">
<div class="navbar-left">
<div class="burger hidden-lg hidden-xl"></div>
<a class="logo" href="https://realvz.github.io/blog">
<span class="logo-text">Re Alvarez Parmar&#x27;s Blog</span>
</a> <div class="sep hidden-xs hidden-sm hidden-sm"></div>
<nav class="main-menu hidden-xs hidden-sm hidden-md">
<ul class="nav-list u-plain-list">
<li class="menu-item menu-item-home"><a class="menu-item-link" href="https://realvarez.com">Home</a></li>
<li class="menu-item menu-item-about"><a class="menu-item-link" href="https://realvz.github.io/blog/about/">About</a></li>
</ul>
</nav>
</div>
<div class="navbar-right">
<div class="toggle-track">
<div class="toggle-moon"><i class="icon icon-brightness-2"></i></div>
<div class="toggle-sun"><i class="icon icon-white-balance-sunny"></i></div>
<div class="toggle-thumb"></div>
</div>
</div>
</div>
</header> <div class="site-content">
<div class="content-area">
<main class="site-main">
<article class="post tag-amazon-eks tag-cost tag-kubernetes tag-scaling single-post">
<header class="post-header big-title container medium">
<h1 class="post-title">Reduce Amazon EKS cost by scaling node groups to zero</h1>
<div class="post-meta">
<span class="post-meta-item post-meta-date">
<time datetime="2022-11-16">Nov 16, 2022</time>
</span>
<span class="post-meta-item post-meta-length">
5 min read
</span>
<span class="post-meta-item post-meta-tags">
<a class="post-tag post-tag-amazon-eks" href="/tag/amazon-eks/" title="Amazon EKS">Amazon EKS</a><a class="post-tag post-tag-cost" href="/tag/cost/" title="Cost">Cost</a><a class="post-tag post-tag-kubernetes" href="/tag/kubernetes/" title="Kubernetes">Kubernetes</a><a class="post-tag post-tag-scaling" href="/tag/scaling/" title="Scaling">Scaling</a>
</span>
</div>
</header> <figure class="post-media container large">
<div class="u-placeholder horizontal">
<a class="post-image-link" href="/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/">
<img class="post-image lazyload u-object-fit" data-srcset="https://images.unsplash.com/photo-1591617870684-6e861e6a48ad?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDR8fGdyYXBofGVufDB8fHx8MTY2ODYyODQ5Ng&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;400 400w, https://images.unsplash.com/photo-1591617870684-6e861e6a48ad?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDR8fGdyYXBofGVufDB8fHx8MTY2ODYyODQ5Ng&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;750 750w, https://images.unsplash.com/photo-1591617870684-6e861e6a48ad?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDR8fGdyYXBofGVufDB8fHx8MTY2ODYyODQ5Ng&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;960 960w, https://images.unsplash.com/photo-1591617870684-6e861e6a48ad?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDR8fGdyYXBofGVufDB8fHx8MTY2ODYyODQ5Ng&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;1140 1140w, https://images.unsplash.com/photo-1591617870684-6e861e6a48ad?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDR8fGdyYXBofGVufDB8fHx8MTY2ODYyODQ5Ng&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;1920 1920w" data-sizes="auto" src="https://images.unsplash.com/photo-1591617870684-6e861e6a48ad?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDR8fGdyYXBofGVufDB8fHx8MTY2ODYyODQ5Ng&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;960" srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Reduce Amazon EKS cost by scaling node groups to zero">
</a>
</div>
<figcaption>Photo by <a href="https://unsplash.com/@edwardhowellphotography?utm_source=ghost&utm_medium=referral&utm_campaign=api-credit">Edward Howell</a> / <a href="https://unsplash.com/?utm_source=ghost&utm_medium=referral&utm_campaign=api-credit">Unsplash</a></figcaption>
</figure>
<div class="post-content gh-content kg-canvas">
<p>Amazon EKS just released the support for <a href="https://aws.amazon.com/blogs/containers/amazon-eks-now-supports-kubernetes-version-1-24/?ref=blog.realvarez.com">Kubernetes version 1.24</a>. The new version supports a bunch of cool features. My favorite feature in this release is the ability to scale EKS managed node groups to (and from) zero.</p><p>Many customers I engage with have some workloads that don’t run continuously. A good example is building software. Software build jobs run when new development teams push new code. Outside of business hours, the supporting infrastructure (like nodes) sits idle. Customers use autoscaling to scale down node groups, but managed node groups required a minimum of 1 node in a node group previously. That’s one node too many, especially when you need beefier and costly nodes with GPUs.</p><p>Scaling down to zero results in significant cost savings in such cases. In my opinion, you wouldn’t want to scale your entire cluster to zero. After all, you’d need some nodes to run Cluster Autoscaler and other shared services like Prometheus, AWS Load Balancer, CoreDNS, etc. You can use EKS on Fargate to run some of these services. But keep in mind that Prometheus requires a block storage, and AWS Fargate doesn’t support Amazon EBS yet.</p><p>You’d want to run a managed node group for your shared services, like Cluster Autoscaler, that run continuously. You can then add another node group for workloads that spawn periodically, and scale that node group to zero.</p><figure class="kg-card kg-image-card"><img src="https://res.craft.do/user/full/9d54cc03-adfe-f72f-3389-565eb7356d1d/doc/1CAE5716-0A06-487B-94D9-ED3A26E55B46/F10EE54C-3121-4A95-A3E8-2084AC07ED39_2/0ePoBv7QUOJphRVgz14AABF7CLN8q6hh0yNumolViQMz/Untitled%20Diagram.drawio.png" class="kg-image" alt="Untitled Diagram.drawio.png" loading="lazy"></figure><h2 id="cluster-autoscaler-managed-node-group-cache">Cluster Autoscaler Managed Node group cache</h2><p>The Kubernetes Cluster Autoscaler project added support for scaling node groups to and from zero in version 0.6.1. However, it only worked if you added <a href="https://github.com/kubernetes/autoscaler/blob/master/cluster-autoscaler/FAQ.md?ref=blog.realvarez.com#how-can-i-scale-a-node-group-to-0">specific tags</a> to Auto Scaling groups. In other words, after creating a managed node group, you had to find out the associated Auto Scaling group and add Cluster Autoscaler tags yourself.</p><p>Starting Kubernetes version 1.24, you can create node groups (or tag existing node groups) with Cluster Autoscaler tags and Cluster Autoscaler will scale that node group to and from zero.</p><p>To enable scaling to and from zero, the awesome EKS team contributed a feature to the upstream Cluster Autoscaler project. The new feature adds a manage node group cache that holds labels and taints associated with managed node groups. Cluster Autoscaler now uses the EKS <a href="https://docs.aws.amazon.com/eks/latest/APIReference/API_DescribeNodegroup.html?ref=blog.realvarez.com"><code>DescribeNodegroup</code></a> API to determine a node's label and taints when there are no nodes in the node group. This allows scaling to and from zero and doesn't require adding Auto Scaling group tags.</p><h2 id="cluster-autoscaler-tags-for-scaling-to-zero">Cluster Autoscaler tags for scaling to zero</h2><p>Before you can start scaling a managed node group to and from zero, you’d need to <a href="https://docs.aws.amazon.com/eks/latest/userguide/autoscaling.html?ref=blog.realvarez.com">add a few tags</a> to your node group. The tags you attach to your node group will help Cluster Autoscaler determine which node group to scale when a Pod is pending. You can add tags that help Cluster Autoscaler taints, labels, and node group’s resources like <code>WindowsENI</code>, <code>PrivateIPv4Address</code>, etc.</p><p>Labels and taints will tell the Kubernetes scheduler to assign Pods to specific nodes. When those Pods don’t have a node to run on (which will be the case when the node group is scaled to zero), Cluster Autoscaler can determine which node group to scale based on the tags. Let’s explore it using an example.</p><h2 id="scaling-a-managed-node-group-from-zero">Scaling a managed node group from zero</h2><p>You’d need a Kubernetes version 1.24 cluster to follow along. My EKS cluster already has node group, and I have <a href="https://docs.aws.amazon.com/eks/latest/userguide/autoscaling.html?ref=blog.realvarez.com">installed Cluster Autoscaler</a> using EKS documentation.</p><p>Cluster Autoscaler needs the permissions to call the EKS <code>DescribeNodegroup</code> API to be able to read a node group's tags. The instructions in EKS documentation currently do not add <code>DescribeNodegroup</code> permissions to the Cluster Autoscaler IAM role.</p><p>The first thing you’d need to do is create an IAM policy that allows the Cluster Autoscaler IAM role to use <code>DescribeNodegroup</code> API.</p><p>Create a policy to allow EKS <code>DescribeNodegroup</code>  API:</p><pre><code class="language-python">cat &gt; describe-nodegroup.json &lt;&lt; EOF
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "eks:DescribeNodegroup"
            ],
            "Effect": "Allow",
            "Resource": "*"
        }
    ]
}
EOF
</code></pre><p>Now you need to add this policy to the Cluster Autoscaler IAM Role. Determine the name of the IAM Role attached to the Cluster Autoscaler service account:</p><pre><code class="language-python">CA_IAM_ROLE=$(kubectl -n kube-system get  sa cluster-autoscaler -o  jsonpath='{.metadata.annotations.eks\.amazonaws\.com/role-arn}' | sed 's|.*/||' )
</code></pre><figure class="kg-card kg-image-card"><img src="https://res.craft.do/user/full/9d54cc03-adfe-f72f-3389-565eb7356d1d/doc/1CAE5716-0A06-487B-94D9-ED3A26E55B46/6EF2F66E-E9B7-4B3D-9D75-06400FAE0BF2_2/gI025AVUilKKRF9GfkjpTeq3GmtiWypNeTVa4uE6XYYz/Image.png" class="kg-image" alt="Image.png" loading="lazy"></figure><p>Then, add the policy you created to the IAM role that Cluster Autoscaler uses:</p><pre><code class="language-python">aws iam put-role-policy --role-name $CA_IAM_ROLE \
  --policy-name EKSDescribeNodegroup \
  --policy-document file://describe-nodegroup.json
</code></pre><p>Now you can start creating a new node group that you can set to scale to and from zero. Find out the role attached to an existing node group in your cluster. You can use AWS CLI to query that information.</p><pre><code class="language-python"># Store your EKS cluster name in an environment variable
EKS_CLUSTER=&lt;YOUR CLUSTER NAME&gt;
AWS_ACCOUNT=$(aws sts get-caller-identity --query 'Account' --output text)

NODE_ROLE=$(aws eks describe-nodegroup \
  --cluster-name $EKS_CLUSTER \
  --nodegroup-name &lt;YOUR NODE GROUP NAME&gt; \
  --query 'nodegroup.nodeRole' \
  --output text)
</code></pre><p>You’d also need to provide the subnets for the new node group. You can use <code>describe-nodegroup</code> to find out the subnets attached to an existing node group.</p><p>Create a node group with a label that you will later use to assign Pods to nodes in this node group:</p><pre><code class="language-python">aws eks create-nodegroup \
 --cli-input-json '
{
  "clusterName": "${EKS_CLUSTER}",
  "nodegroupName": "scale-to-zero",
  "scalingConfig": {
     "minSize": 0,
     "maxSize": 5,
     "desiredSize": 0
  },
  "subnets": [
     "&lt;subnet-ID1&gt;",
     "&lt;subnet-ID2&gt;",
     "&lt;subnet-ID3&gt;"
   ],
  "nodeRole": "${NODE_ROLE}",
  "labels": {
     "app": "frontend"
  },
  "tags": {
     "k8s.io/cluster-autoscaler/node-template/label/app": "frontend"
  }
}'
</code></pre><p><em>Replace the subnet IDs to match your environment.</em></p><p>Note that I added a tag <code>k8s.io/cluster-autoscaler/node-template/label/app</code> with value <code>frontend</code>. This is the same as running <code>kubectl label nodes &lt;YOUR NODE NAME&gt; app=frontend</code>. When a node gets created in this node group, it will already have label <code>app=frontend</code>.</p><p>Now that the node group is created, let’s create a pod with a nodeSelector:</p><pre><code class="language-python">cat &lt;&lt;EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: nginx-test
spec:
  containers:
  - name: nginx
    image: nginx:latest
  nodeSelector:
    app: frontend
EOF
</code></pre><p>The pod will remain pending for a few minutes. In my case, the pod was in pending state for five minutes.</p><p>In the meantime, you can see Cluster Autoscaler logs:</p><p><code>kubectl -n kube-system logs -f deployment.apps/cluster-autoscaler | grep scale-to-zero</code></p><p>Once Cluster Autoscaler adds a new node, the pod will start running. You can enable <a href="https://aws.amazon.com/blogs/containers/automatically-enable-group-metrics-collection-for-amazon-eks-managed-node-groups/?ref=blog.realvarez.com">Auto Scaling group metrics collection</a> to see how your node group scales.</p><figure class="kg-card kg-image-card"><img src="https://res.craft.do/user/full/9d54cc03-adfe-f72f-3389-565eb7356d1d/doc/1CAE5716-0A06-487B-94D9-ED3A26E55B46/D344F40B-8692-4F2F-921C-422DA115E1B7_2/qBfnOkqluRY1yVqZBaMsB6K5xJgA1idkKOxkkfmzx8Az/Image.jpeg" class="kg-image" alt="Image.jpeg" loading="lazy"></figure><p>Great! Cluster Autoscaler saw that the test pod was pending, so it scaled the node group from 0.</p><p>Now let’s delete the test pod and verify that the node group goes back to 0:</p><pre><code class="language-python">kubectl delete pods nginx-test
</code></pre><p>Cluster Autoscaler will notice that the node with app=frontend is not running any pods and scale down the node group (after the cooldown period).</p><figure class="kg-card kg-image-card"><img src="https://res.craft.do/user/full/9d54cc03-adfe-f72f-3389-565eb7356d1d/doc/1CAE5716-0A06-487B-94D9-ED3A26E55B46/EAD1C890-6DB1-455E-BABB-FAF71E5FD960_2/kDUeT7u0sJs3WqNy7SG8FBvHyHi9ALDkNEsxsuL1jtIz/Image.jpeg" class="kg-image" alt="Image.jpeg" loading="lazy"></figure><p>Perfect, the node group is back to having 0 nodes.</p><h2 id="conclusion">Conclusion</h2><p>Scaling down to zero can result in significant cost savings when you have workloads that don’t run 24x7. With Kubernetes 1.24, all you need to do is tag your node groups with labels, taints, or resources, and Cluster Autoscaler will scale your nodes to and from zero.</p><p>Happy scaling!</p>
</div>
<div class="container medium">
<div class="share u-hover-wrapper">
<a class="share-item share-facebook u-hover-item" href="https://www.facebook.com/sharer.php?u=https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/" target="_blank" rel="noopener"><i class="icon icon-facebook"></i></a>
<a class="share-item share-twitter u-hover-item" href="https://twitter.com/intent/tweet?url=https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/&text=Reduce%20Amazon%20EKS%20cost%20by%20scaling%20node%20groups%20to%20zero" target="_blank" rel="noopener"><i class="icon icon-twitter"></i></a>
<a class="share-item share-pinterest u-hover-item" href="https://pinterest.com/pin/create/button/?url=https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/&media=&description=Reduce%20Amazon%20EKS%20cost%20by%20scaling%20node%20groups%20to%20zero" target="_blank" rel="noopener" data-pin-do="none"><i class="icon icon-pinterest"></i></a>
<a class="share-item share-linkedin u-hover-item" href="https://www.linkedin.com/shareArticle?mini=true&url=https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/&title=Reduce%20Amazon%20EKS%20cost%20by%20scaling%20node%20groups%20to%20zero" target="_blank" rel="noopener"><i class="icon icon-linkedin"></i></a>
<a class="share-item share-reddit u-hover-item" href="https://reddit.com/submit?url=https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/&title=Reduce%20Amazon%20EKS%20cost%20by%20scaling%20node%20groups%20to%20zero" target="_blank" rel="noopener"><i class="icon icon-reddit"></i></a>
<a class="share-item share-tumblr u-hover-item" href="https://www.tumblr.com/widgets/share/tool?canonicalUrl=https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/&title=Reduce%20Amazon%20EKS%20cost%20by%20scaling%20node%20groups%20to%20zero" target="_blank" rel="noopener"><i class="icon icon-tumblr"></i></a>
<a class="share-item share-vk u-hover-item" href="http://vk.com/share.php?url=https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/&title=Reduce%20Amazon%20EKS%20cost%20by%20scaling%20node%20groups%20to%20zero" target="_blank" rel="noopener"><i class="icon icon-vk"></i></a>
<a class="share-item share-pocket u-hover-item" href="https://getpocket.com/edit?url=https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/" target="_blank" rel="noopener"><i class="icon icon-pocket"></i></a>
<a class="share-item share-telegram u-hover-item" href="https://t.me/share/url?url=https://realvz.github.io/blog/reduce-amazon-eks-cost-by-scaling-node-groups-to-zero/&text=Reduce%20Amazon%20EKS%20cost%20by%20scaling%20node%20groups%20to%20zero" target="_blank" rel="noopener"><i class="icon icon-telegram"></i></a>
</div> </div>
</article>
<div class="navigation container medium">
<div class="navigation-item navigation-previous">
<a class="navigation-item-link button-arrow button-arrow-left" href="/book-review-the-dawn-of-everything-by-david-graeber-david-wengrow/">
<i class="button-arrow-icon icon icon-arrow-left"></i> Previous Post
</a>
</div>
<div class="navigation-item navigation-next">
<a class="navigation-item-link button-arrow button-arrow-right" href="/use-containerd-to-handle-k8s-gcr-io-deprecation/">
Next Post <i class="button-arrow-icon icon icon-arrow-right"></i>
</a>
</div>
</div> <section class="related-posts container medium">
<h3 class="related-title"><span class="text">You might also like...</span></h3>
<div class="row">
<div class="col-md-4 related-column">
<article class="post tag-nvidia tag-machine-learning tag-amazon-eks tag-kubernetes">
<figure class="post-media">
<div class="u-placeholder rectangle">
<a class="post-image-link" href="/get-more-out-of-gpus-with-nvidia-multi-instance-gpu/">
<img class="post-image lazyload u-object-fit" data-srcset="https://images.unsplash.com/photo-1536620752150-a7e9e62a62ee?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDI5fHx2ZXJ0aWNhbCUyMGxpbmVzfGVufDB8fHx8MTY4NDg4NDU5OHww&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;400 400w, https://images.unsplash.com/photo-1536620752150-a7e9e62a62ee?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDI5fHx2ZXJ0aWNhbCUyMGxpbmVzfGVufDB8fHx8MTY4NDg4NDU5OHww&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;750 750w, https://images.unsplash.com/photo-1536620752150-a7e9e62a62ee?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDI5fHx2ZXJ0aWNhbCUyMGxpbmVzfGVufDB8fHx8MTY4NDg4NDU5OHww&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;960 960w, https://images.unsplash.com/photo-1536620752150-a7e9e62a62ee?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDI5fHx2ZXJ0aWNhbCUyMGxpbmVzfGVufDB8fHx8MTY4NDg4NDU5OHww&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;1140 1140w, https://images.unsplash.com/photo-1536620752150-a7e9e62a62ee?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDI5fHx2ZXJ0aWNhbCUyMGxpbmVzfGVufDB8fHx8MTY4NDg4NDU5OHww&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;1920 1920w" data-sizes="auto" src="https://images.unsplash.com/photo-1536620752150-a7e9e62a62ee?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDI5fHx2ZXJ0aWNhbCUyMGxpbmVzfGVufDB8fHx8MTY4NDg4NDU5OHww&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;960" srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Run more pods per GPU with NVIDIA Multi-Instance GPU">
</a>
</div>
</figure>
<header class="post-header">
<h2 class="post-title">
<a class="post-title-link" href="/get-more-out-of-gpus-with-nvidia-multi-instance-gpu/">Run more pods per GPU with NVIDIA Multi-Instance GPU</a>
</h2>
<div class="post-meta">
<span class="post-meta-item post-meta-date">
<time datetime="2023-05-23">May 23, 2023</time>
</span>
<span class="post-meta-item post-meta-length">
10 min read
</span>
<span class="post-meta-item post-meta-tags">
<a class="post-tag post-tag-nvidia" href="/tag/nvidia/" title="NVIDIA">NVIDIA</a><a class="post-tag post-tag-machine-learning" href="/tag/machine-learning/" title="Machine Learning">Machine Learning</a><a class="post-tag post-tag-amazon-eks" href="/tag/amazon-eks/" title="Amazon EKS">Amazon EKS</a><a class="post-tag post-tag-kubernetes" href="/tag/kubernetes/" title="Kubernetes">Kubernetes</a>
</span>
</div>
</header> </article>
</div>
<div class="col-md-4 related-column">
<article class="post tag-amazon-eks tag-kubernetes tag-scaling">
<figure class="post-media">
<div class="u-placeholder rectangle">
<a class="post-image-link" href="/autoscale-kubernetes-metrics-server/">
<img class="post-image lazyload u-object-fit" data-srcset="https://images.unsplash.com/photo-1616085290809-064fcf10dc4a?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDN8fGV4cGFuZHxlbnwwfHx8fDE2Njc1MDg5MTk&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;400 400w, https://images.unsplash.com/photo-1616085290809-064fcf10dc4a?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDN8fGV4cGFuZHxlbnwwfHx8fDE2Njc1MDg5MTk&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;750 750w, https://images.unsplash.com/photo-1616085290809-064fcf10dc4a?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDN8fGV4cGFuZHxlbnwwfHx8fDE2Njc1MDg5MTk&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;960 960w, https://images.unsplash.com/photo-1616085290809-064fcf10dc4a?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDN8fGV4cGFuZHxlbnwwfHx8fDE2Njc1MDg5MTk&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;1140 1140w, https://images.unsplash.com/photo-1616085290809-064fcf10dc4a?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDN8fGV4cGFuZHxlbnwwfHx8fDE2Njc1MDg5MTk&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;1920 1920w" data-sizes="auto" src="https://images.unsplash.com/photo-1616085290809-064fcf10dc4a?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDN8fGV4cGFuZHxlbnwwfHx8fDE2Njc1MDg5MTk&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;960" srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Autoscale Kubernetes Metrics Server">
</a>
</div>
</figure>
<header class="post-header">
<h2 class="post-title">
<a class="post-title-link" href="/autoscale-kubernetes-metrics-server/">Autoscale Kubernetes Metrics Server</a>
</h2>
<div class="post-meta">
<span class="post-meta-item post-meta-date">
<time datetime="2022-11-03">Nov 3, 2022</time>
</span>
<span class="post-meta-item post-meta-length">
6 min read
</span>
<span class="post-meta-item post-meta-tags">
<a class="post-tag post-tag-amazon-eks" href="/tag/amazon-eks/" title="Amazon EKS">Amazon EKS</a><a class="post-tag post-tag-kubernetes" href="/tag/kubernetes/" title="Kubernetes">Kubernetes</a><a class="post-tag post-tag-scaling" href="/tag/scaling/" title="Scaling">Scaling</a>
</span>
</div>
</header> </article>
</div>
<div class="col-md-4 related-column">
<article class="post tag-amazon-eks tag-kubernetes tag-containers tag-containerd">
<figure class="post-media">
<div class="u-placeholder rectangle">
<a class="post-image-link" href="/using-estargz-to-reduce-container-startup-time-on-amazon-eks/">
<img class="post-image lazyload u-object-fit" data-srcset="https://images.unsplash.com/photo-1578923931302-7fd9b3495be7?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDExfHxob3VyZ2xhc3N8ZW58MHx8fHwxNjY2NzM5NTc3&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;400 400w, https://images.unsplash.com/photo-1578923931302-7fd9b3495be7?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDExfHxob3VyZ2xhc3N8ZW58MHx8fHwxNjY2NzM5NTc3&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;750 750w, https://images.unsplash.com/photo-1578923931302-7fd9b3495be7?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDExfHxob3VyZ2xhc3N8ZW58MHx8fHwxNjY2NzM5NTc3&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;960 960w, https://images.unsplash.com/photo-1578923931302-7fd9b3495be7?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDExfHxob3VyZ2xhc3N8ZW58MHx8fHwxNjY2NzM5NTc3&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;1140 1140w, https://images.unsplash.com/photo-1578923931302-7fd9b3495be7?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDExfHxob3VyZ2xhc3N8ZW58MHx8fHwxNjY2NzM5NTc3&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;1920 1920w" data-sizes="auto" src="https://images.unsplash.com/photo-1578923931302-7fd9b3495be7?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDExfHxob3VyZ2xhc3N8ZW58MHx8fHwxNjY2NzM5NTc3&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;960" srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Using eStargz to reduce container startup time on Amazon EKS">
</a>
</div>
</figure>
<header class="post-header">
<h2 class="post-title">
<a class="post-title-link" href="/using-estargz-to-reduce-container-startup-time-on-amazon-eks/">Using eStargz to reduce container startup time on Amazon EKS</a>
</h2>
<div class="post-meta">
<span class="post-meta-item post-meta-date">
<time datetime="2022-10-25">Oct 25, 2022</time>
</span>
<span class="post-meta-item post-meta-length">
7 min read
</span>
<span class="post-meta-item post-meta-tags">
<a class="post-tag post-tag-amazon-eks" href="/tag/amazon-eks/" title="Amazon EKS">Amazon EKS</a><a class="post-tag post-tag-kubernetes" href="/tag/kubernetes/" title="Kubernetes">Kubernetes</a><a class="post-tag post-tag-containers" href="/tag/containers/" title="Containers">Containers</a><a class="post-tag post-tag-containerd" href="/tag/containerd/" title="Containerd">Containerd</a>
</span>
</div>
</header> </article>
</div>
</div>
</section>
</main>
</div>
</div>
<footer class="site-footer container large">
<div class="copyright">
Powered by <a href="https://ghost.org/" target="_blank" rel="noopener">Ghost</a>
</div>
<nav class="footer-nav">
<ul class="nav-list u-plain-list">
<li class="menu-item menu-item-sign-up"><a class="menu-item-link" href="https://realvz.github.io/blog/#/portal/">Sign up</a></li>
</ul>
</nav>
<div class="footer-social">
<a class="footer-social-item footer-social-item-twitter" href="https://twitter.com/realz" target="_blank" rel="noopener" aria-label="Twitter">
<i class="icon icon-twitter"></i>
</a>
<a class="footer-social-item footer-social-item-rss" href="https://feedly.com/i/subscription/feed/https://realvz.github.io/blog/rss/" target="_blank" rel="noopener" aria-label="RSS">
<i class="icon icon-rss"></i>
</a>
</div>
</footer> </div>
<div class="dimmer"></div>
<div class="off-canvas">
<div class="canvas-close">
<i class="canvas-icon icon icon-window-close"></i>
</div>
<div class="mobile-menu"></div>
</div>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous">
    </script>
<script src="/assets/built/main.min.js?v=ce0a9a97d4"></script>
</body>
</html>